user share share;
worker_processes auto;
error_log /dev/stderr;

events {
        worker_connections  4096;
}

http {
        include /etc/nginx/mime.types;

        server {
                listen 8888 default;
                listen [::]:8888 default;
                server_name nas.foxden.network;
                root /mnt/nas;
                autoindex on;

                location / {
                        auth_pam "FoxDen NAS";
                        auth_request "/auth_smb";
                }

                location /guest/ {

                }

                location = /auth_smb {
                        internal;
                        content_by_lua_file /etc/nginx/auth_smb.lua;
                }
        }
}
